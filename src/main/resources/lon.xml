<?xml version="1.0" encoding="UTF-8"?>

<infinispan
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="urn:infinispan:config:11.0  http://www.infinispan.org/schemas/infinispan-config-11.0.xsd"
        xmlns="urn:infinispan:config:11.0">


    <jgroups>
        
        <stack name="bridge" extends="tcp">
            <TCP enable_diagnostics="true"/>
            <relay.RELAY2 site="LON" xmlns="urn:org:jgroups" max_site_masters="1" stack.combine="INSERT_AFTER" stack.position="FRAG3"/>
        </stack>
        
        <stack name="xsite" extends="udp">
            <UDP enable_diagnostics="true"/>

            <relay.RELAY2 site="LON" xmlns="urn:org:jgroups" max_site_masters="1" stack.combine="INSERT_AFTER" stack.position="FRAG3"/>
            <remote-sites default-stack="bridge">
                <remote-site name="LON"/>
                <remote-site name="NYC"/>
            </remote-sites>

        </stack>

    </jgroups>

   <!-- <threads>
        <thread-factory name="transport-factory"/>
        <blocking-bounded-queue-thread-pool name="custom-remote" core-threads="0" max-threads="1000"
                                            keepalive-time="60000" queue-length="5" thread-factory="transport-factory"/>
    </threads>-->


    <cache-container name="default" default-cache="perf-cache">
        <!--transport stack="jgroupsStack" lock-timeout="600000" cluster="default" remote-command-executor="custom-remote" /-->
        <transport stack="xsite" lock-timeout="600000" cluster="default" />
        <jmx>
            <property name="enabled">true</property>
        </jmx>
        <distributed-cache name="perf-cache" remote-timeout="60000" statistics="true" l1-lifespan="-1" segments="512" >
            <locking acquire-timeout="3000" concurrency-level="1000" />
            <state-transfer timeout="60000" />
        </distributed-cache>
    </cache-container>

</infinispan>